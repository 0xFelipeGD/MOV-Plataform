# =============================================================================
# MOV Platform - Configuração Mosquitto MQTT Broker
# =============================================================================
# Este arquivo é usado tanto em desenvolvimento quanto em produção.
# Em produção, o script deploy.sh adiciona automaticamente a configuração SSL.
# =============================================================================

# Configurações por listener (permite diferentes configurações por porta)
per_listener_settings true

# Persistência de dados
persistence true
persistence_location /mosquitto/data/

# Logs
log_dest stdout
log_type error
log_type warning
log_type notice
log_type information
log_timestamp true

# =============================================================================
# DESENVOLVIMENTO - Portas sem SSL
# =============================================================================

# Porta MQTT padrão (Telegraf, dispositivos locais, testes)
listener 1883
protocol mqtt
allow_anonymous false
password_file /mosquitto/config/passwd

# Porta WebSockets (dashboards web futuros)
listener 9001
protocol websockets
allow_anonymous false
password_file /mosquitto/config/passwd

# =============================================================================
# PRODUÇÃO - Porta SSL (adicionada automaticamente por deploy.sh)
# =============================================================================
# listener 8883
# protocol mqtt
# cafile /mosquitto/certs/ca.crt
# certfile /mosquitto/certs/server.crt
# keyfile /mosquitto/certs/server.key
# require_certificate false
# allow_anonymous false
# password_file /mosquitto/config/passwd